　　**git**是一种基于分布式的版本控制系统，之前对git的了解很少，通过课上学习发现git在开发当中非常实用，下面就从四个常见的场景来学习一下git的使用。   

　　(首先电脑上应该安装过git，或者有vscode时，已经附带安装了git)

**一、场景一：git本地版本库的基本用法**

1.1初始化一个git本地版本库

```
在vs code 中先打开一个项目文件夹（ctrl+O），如果没有git存储库时，打开源代码管理（ctrl+shift+G），点击“初始化存储库”，就可以初始化一个git本地版本库了，见下图。
```

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201002213707945-546789216.png)

 如果使用命令行完成上面的操作，直接在项目根目录下使用下面的命令也可完成初始化本地版本库：

```
1. git init  #初始化一个git本地版本库
```

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201002215041334-1996968504.png)

 完成初始化后，在当前文件夹中会多出一个隐藏的.git 文件夹，如下图

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201002215224280-968362651.png)

1.2 查看当前workspace状态

　　新建一个文件1.txt并保存，在终端中运行 git status 命令，如下图：

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201002220110659-780887794.png)

 1.3 暂存更改的文件

　　可以在vscode中的【更改】列表里点击''+"实现，将更改的文件加入到【暂存的更改】列表中，也可以在终端中使用命令"git add 1.txt"实现，如下图：

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201002220946883-566307120.png)

 ![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201002221100223-658216120.png)

 　如果想放弃更改，可以点击【暂存的更改】列表下1.txt一栏中的“-”实现，或者使用命令：git checkout -- 1.txt

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201002221641374-41598453.png)

 注意：git add . 命令是将当前目录下的所有文件添加到暂存区中

　　　*git checkout . 命令是将放弃暂存区中所有文件的更改，与点击【暂存的更改】列表中一栏的“-”功能相同，如下图：*

*![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201002222322391-125362467.png)*

 1.4 将暂存区中的文件提交到仓库

　　点击【暂存的更改】列表对号“√”可将暂存的文件提交到仓库中，注意在提交之前会要求输入提交日志消息。

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201002223108688-447488973.png)

 或者使用命令：git commit -m "描述信息" ，将暂存区中的文件提交到仓库中。

```
git reflog   #查看当前HEAD之后提交的记录
git log     #查看HEAD及其之前的提交记录
git reset --hard HEAD^  #让HEAD回退到HEAD的前一个版本

git reset —-hard HEAD^^

git reset —-hard HEAD~100

git reset —-hard 128个字符的commit-id
如上命令可以让HEAD回退到任意一个版本，比如HEAD^表示HEAD的前一个版本、HEAD^^表示HEAD的前两个版本、HEAD~100表示HEAD的前100个版本，也可以用版本号字符串commit-id来指定回退到任意一个版本。
```

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201002235434714-1755921352.png)

 **二、场景二：git远程版本库的基本用法**

　　在vscode中在【源代码管理】点击【克隆】如下图，然后输入github中存储库的url，按enter键选择要保存的目录，就可将远程版本库克隆到本地。

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201003215753646-201641429.png)

 也可以通过git clone url 命令对github上的版本库克隆到本地。

```
除了git clone 命令，远程操作的命令还有:
git fetch #下载一个远程存储库数据对象等信息到本地
git push  #将本地存储库的数据更新到远程存储库
git merge  #合并两个或者多个开发历史记录
git pull   #用于从远程获取代码并合并本地的版本
注：git pull 是git fetch 和 git merge FETCH_HEAD 的简写
```

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201003222515367-1076364455.png)

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201003222423200-1630544319.png)

 ![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201003223058268-1325390430.png)

 然后在github上就可以看到提交的文件了：

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201003223230017-342921570.png)

 **三、 场景三：团队项目中的分叉合并**

 一个团队中多人同时向origin/master分支提交代码，可能会有冲突合并情况的发生；也可能会带来整个git log提交记录中多个开发者或多个代码模块的commit是交错排列在同一条时间线上，不利于回顾查看和回退代码，让跟踪代码的成长轨迹变得异常困难。

因此建议团队中的开发者采用如下的工作流程：

1. 克隆或同步最新的代码到本地存储库
2. 为自己的工作创建一个分支，该分支应该只负责单一功能模块或代码模块的版本控制
3. 在该分支上完成某单一功能或代码模块的开发工作
4. 最后将该分支合并到主分支

> *注意：默认的合并方式是“快进式合并”（fast-farward merge）,快递式合并会将分支commit合并到主分支里，合并成一条时间线。*
>
> ![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201004000250211-1988237754.png)
>
> 　　如果要呈现一段独立的分支线，合并时需要使用--no-ff参数关闭“快递式合并”。
>
> ![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201004000312504-898733826.png)
>
>  

下面将模拟一遍上面的流程：

1.克隆或同步最新的代码到本地版本库

```
1 git clone https://DOMAIN_NAME/YOUR_NAME/REPO_NAME.git
2 git pull
```

2.创建一个分支， 如命名为 mybranch

```
1 git checkout -b mybranch
2 git branch     
```

如下图：

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201003230926219-764196049.png)

 3.在创建的分支上进行多次开发工作，如下：

 ![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201003231105251-1017984930.png)

 4.切换到master分支，将远程origin/master同步更新到本地版本库，再合并mybranch到master分支，push推送到远程master分支，完成一项开发工作。

 ![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201003231131973-1593116451.png)

 　完成后，可以在github对应仓库的**Insights**下面的**Network**中看到对应的**Network graph**，如下图蓝色的分支可以看出分支上有一次合并到master。

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201003231217194-526726196.png)

**四 、场景四：git rebase的使用**

 　git rebase命令可以将分叉的分支重新合并，在提交自己独立的代码时，为了让提交的记录尽量干净整洁方便团队开发，检查自己的commit记录十分重要。在上面的场景三中，mybranch分支完成工作之后，为了让log记录容易回顾参考，在push之前用git rebase重新整理一下提交记录。***注意，不要通过rebase对任何已经push到远程仓库的commit进行修改！***

　　下面，新建6.txt分别进行三次修改，提交到暂存栈，并用commit记录下提交信息，然后用git log或者git log --pretty=oneline 命令查看提交记录，如下图：![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201005140636095-1738812163.png)

 git log --pretty=oneline 命令：

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201005140734029-1627296052.png)

 然后，使用git rebase -i HEAD^^^命令，重新整理HEAD之前的三个commit节点。

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201005014929494-1801126691.png)

 输入上面的命令按下回车后，会打开命令行文本编辑器模式，如下图：

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201005140807566-1609064481.png)

 　该文本编辑器与vim使用大致相同，按i键进入插入编辑模式，此事我将 “pick cc1912a 62 ”对应的一行记录删掉，如下图，最后按esc键退出到编辑模式回到一般命令模式，再按：键进入底线命令模式，输入wq，保存退出。（输入:wq保存退出、输入:q退出、输入:q!强制退出）

 ![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201005140900937-1345057067.png)

 这时vscode会打开冲突文件，可以根据提示选择保留哪个更改，也可以直接编辑文件去掉提示信息。

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201005140942389-1943202686.png)

 解决冲突后，把修改后的文件git add 一下，然后使用git rebase --continue ，成功。

![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201005221913888-2096864903.png)

 *然后我们查看一下是否删除记录成功，git log --pretty=oneline，发现成功将62记录删除。*

 ![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201005221940572-2040500215.png)

 　如果我们想撤销git rebase操作，使用git rebase --abort 命令。

　　最后，切换到master分支，将远程master同步更新到本地存储库，将mybranch合并到master分支，push到远程即完成了开发工作。

 ![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201005222154733-870277736.png)

看一下git graph：

 ![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201005222310524-2079262034.png)

 ![img](https://img2020.cnblogs.com/blog/2164343/202010/2164343-20201005222929430-1359852292.png)

**总结**

 　通过对git四大常见的场景的学习，自己对git有了初步的了解，接下来还要对git进行更多的使用和学习。

　　以上如有不对之处，欢迎批评指正~~~

　　参考链接：https://mp.weixin.qq.com/s/Km5KuXPETvG0wCGHrvj9Vg

 